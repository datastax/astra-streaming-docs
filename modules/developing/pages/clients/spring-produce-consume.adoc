= Use the Java Pulsar client with {product} and Spring
:navtitle: Spring
:description: Produce and consume messages with the Java Pulsar client, {product}, and Spring.
:page-tag: astra-streaming,dev,develop,pulsar,java

You can produce and consume messages with the Java Pulsar client, {product}, and Spring.

== Prerequisites

You will need the following prerequisites in place to complete this guide:

* JRE 8 installed (https://sdkman.io/[install now,title=Install java])
* (https://maven.apache.org/install.html[Maven,title=Maven]) or (https://gradle.org/install/[Gradle,title=Gradle]) installed
* A working Pulsar topic (get started xref:getting-started:index.adoc[here] if you don't have a topic)
* A basic text editor or IDE

[TIP]
====
Visit our https://github.com/datastax/astra-streaming-examples[examples repo] to see the complete source of this example.
====

== Create a Maven project in Spring Initializr

Spring Initializr is a great tool to quickly create a project with the dependencies you need. Let's use it to create a project with the Pulsar client dependency.

. Go to https://start.spring.io/[Spring Initializr] to initialize a new project.

. Select Maven, Java 17, a non-SNAPSHOT version of Spring Boot, and the Apache Pulsar dependency:
+
image::spring-initializr.png[Spring Initializr]

. Click *Generate Project*, download the zip file, and then extract it.

. Navigate to `src/main/java`, and then open the `DemoApplication.java` file.
This file contains the main method that will run your application with the dependencies specified.
+
.DemoApplication.java
[%collapsible]
====
[source,java]
----
include::{astra-streaming-examples-repo}/java/spring-boot/SpringBoot/src/main/java/com/example/demo/DemoApplication.java[]
----
====

. Replace the following values in `DemoApplication.java` with values from your tenant's *Connect* tab in the {astra_ui}:
+
.DemoApplication.java
[source,java,subs="+quotes"]
----
	private static final String serviceUrl = "pulsar+ssl://pulsar-**PROVIDER**-**REGION**.streaming.datastax.com:**PORT**";
	private static final String pulsarToken = "**PULSAR_JTW_TOKEN**";
	private static final String tenantName = "**TENANT_NAME**";
	private static final String namespace = "**NAMESPACE_NAME**";
	private static final String topicName = "**TOPIC_NAME**";
----
+
You can also modify the values in the `application.properties` file in the `/resources` directory, which is recommended for production applications.
On your tenant's *Connect* tab, you can download a properties file with the values your application needs to connect to your {product} instance.
+
.Spring application properties
[%collapsible]
====
[source,yaml]
----
include::{astra-streaming-examples-repo}/java/spring-boot/SpringBoot/src/main/resources/application.properties[]
----
====

. From your project's root directory, compile the Java application with the Pulsar client dependency:
+
[source,bash]
----
mvn clean compile
----
+
.Result
[%collapsible]
====
[source,console]
----
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  0.819 s
[INFO] Finished at: 2023-05-09T15:36:33-04:00
[INFO] ------------------------------------------------------------------------
----
====

. Run the project to send a message to your {product} cluster:
+
[source,bash]
----
mvn spring-boot:run
----
+
.Result
[%collapsible]
====
[source,console]
----
Message received: Hello World
----
====

. In the {astra_ui}, go to your tenant to verify that the message appears in the specified namespace and topic.

== See also

* xref:developing:configure-pulsar-env.adoc[]
* xref:developing:astream-functions.adoc[]
* xref:streaming-learning:pulsar-io:connectors/index.adoc[]
